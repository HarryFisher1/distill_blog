<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Investigating sports injuries with Bayesian networks using {bnlearn}</title>

  <meta property="description" itemprop="description" content="This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-11-17"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-11-17"/>
  <meta name="article:author" content="Harry Fisher"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Investigating sports injuries with Bayesian networks using {bnlearn}"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Investigating sports injuries with Bayesian networks using {bnlearn}"/>
  <meta property="twitter:description" content="This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=A Bayesian approach to sport injuries likelihood: Does player’s self-efficacy and environmental factors plays the main role?;citation_publication_date=2018;citation_volume=9;citation_doi=10.3389/fpsyg.2018.01174;citation_issn=16641078;citation_author=Aurelio Olmedilla;citation_author=Víctor J. Rubio;citation_author=Pilar Fuster-Parra;citation_author=Constanza Pujals;citation_author=Alexandre García-Mas"/>
  <meta name="citation_reference" content="citation_title=Bayesian networks to identify statistical dependencies. A case study of Spanish university students’ habits;citation_publication_date=2017;citation_publisher=Taylor &amp; Francis;citation_volume=42;citation_doi=10.1080/17538157.2016.1178117;citation_issn=17538165;citation_author=P. Fuster-Parra;citation_author=J. Vidal-Conti;citation_author=P. A. Borràs;citation_author=P. Palou"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","preview","categories","bibliography","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["Investigating sports injuries with Bayesian networks using {bnlearn}"]},{"type":"character","attributes":{},"value":["This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Harry Fisher"]},{"type":"character","attributes":{},"value":["https://www.hfshr.xyz"]}]}]},{"type":"character","attributes":{},"value":["11-17-2020"]},{"type":"character","attributes":{},"value":["bn.png"]},{"type":"character","attributes":{},"value":["R","Bayesian Network"]},{"type":"character","attributes":{},"value":["r-references.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"logical","attributes":{},"value":[false]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bayesian-networks-with-bnlearn_files/anchor-4.2.2/anchor.min.js","bayesian-networks-with-bnlearn_files/bowser-1.9.3/bowser.min.js","bayesian-networks-with-bnlearn_files/distill-2.2.21/template.v2.js","bayesian-networks-with-bnlearn_files/figure-html5/unnamed-chunk-4-1.png","bayesian-networks-with-bnlearn_files/figure-html5/unnamed-chunk-8-1.png","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/css/font-awesome.css","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/css/font-awesome.css.map","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/css/font-awesome.min.css","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/fontawesome-webfont.eot","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/fontawesome-webfont.svg","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/fontawesome-webfont.ttf","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/fontawesome-webfont.woff","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/fontawesome-webfont.woff2","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/fonts/FontAwesome.otf","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/animated.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/bordered-pulled.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/core.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/fixed-width.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/font-awesome.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/icons.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/larger.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/list.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/mixins.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/path.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/rotated-flipped.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/screen-reader.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/stacked.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/less/variables.less","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_animated.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_bordered-pulled.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_core.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_fixed-width.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_icons.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_larger.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_list.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_mixins.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_path.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_rotated-flipped.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_screen-reader.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_stacked.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/_variables.scss","bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/scss/font-awesome.scss","bayesian-networks-with-bnlearn_files/header-attrs-2.5/header-attrs.js","bayesian-networks-with-bnlearn_files/header-attrs-2.6.4/header-attrs.js","bayesian-networks-with-bnlearn_files/header-attrs-2.6.6/header-attrs.js","bayesian-networks-with-bnlearn_files/header-attrs-2.7.4/header-attrs.js","bayesian-networks-with-bnlearn_files/htmlwidgets-1.5.1/htmlwidgets.js","bayesian-networks-with-bnlearn_files/htmlwidgets-1.5.3/htmlwidgets.js","bayesian-networks-with-bnlearn_files/jquery-1.11.3/jquery.min.js","bayesian-networks-with-bnlearn_files/popper-2.6.0/popper.min.js","bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy-bundle.umd.min.js","bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy-light-border.css","bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy.css","bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy.umd.min.js","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/acceptDeleteIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/addNodeIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/backIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/connectIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/cross.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/cross2.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/deleteIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/downArrow.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/editIcon.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/leftArrow.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/minus.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/plus.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/rightArrow.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/upArrow.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/img/network/zoomExtends.png","bayesian-networks-with-bnlearn_files/vis-4.20.1/vis.css","bayesian-networks-with-bnlearn_files/vis-4.20.1/vis.min.js","bayesian-networks-with-bnlearn_files/visNetwork-binding-2.0.9/visNetwork.js","bayesian-networks-with-bnlearn_files/webcomponents-2.0.0/webcomponents.js","bn.png","injuries.csv","r-references.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="bayesian-networks-with-bnlearn_files/header-attrs-2.7.4/header-attrs.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <link href="bayesian-networks-with-bnlearn_files/vis-4.20.1/vis.css" rel="stylesheet" />
  <script src="bayesian-networks-with-bnlearn_files/vis-4.20.1/vis.min.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/visNetwork-binding-2.0.9/visNetwork.js"></script>
  <link href="bayesian-networks-with-bnlearn_files/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="bayesian-networks-with-bnlearn_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/popper-2.6.0/popper.min.js"></script>
  <link href="bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="bayesian-networks-with-bnlearn_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="bayesian-networks-with-bnlearn_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Investigating sports injuries with Bayesian networks using {bnlearn}","description":"This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury.","authors":[{"author":"Harry Fisher","authorURL":"https://www.hfshr.xyz","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-11-17T00:00:00.000+00:00","citationText":"Fisher, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Investigating sports injuries with Bayesian networks using {bnlearn}</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">R</div>
<div class="dt=tag">Bayesian Network</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>This post explores the use of Bayesian networks with the excellent {bnlearn} package to examine the relationship between different risk factors and the probability of sustaining a sports injury.</p></p>
</div>

<div class="d-byline">
  Harry Fisher <a href="https://www.hfshr.xyz" class="uri">https://www.hfshr.xyz</a> 
  
<br/>11-17-2020
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#so-what-is-a-bayesian-network">So what is a Bayesian network?</a></li>
<li><a href="#enough-theory-some-examples">Enough theory, some examples!</a></li>
<li><a href="#network-preparation">Network preparation</a></li>
<li><a href="#fitting-the-network">Fitting the network</a></li>
<li><a href="#interrogating-the-network">Interrogating the network</a></li>
<li><a href="#bonus-visulaisation-with-bnviewer">Bonus visulaisation with {bnviewer}</a></li>
<li><a href="#summary">Summary</a>
<ul>
<li><a href="#resources">Resources</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>In this post I want to share a few details about the humble Bayesian Network (BN). While not generally considered one of the “mainstream” forms of analysis, Bayesian networks have several features that make them an interesting choice, including their flexibility, interpretability and visually appealing nature. I used BNs during PhD, and was fortunate enough to receive some guidance from <a href="https://www.bnlearn.com/about/">Marco Scutari</a>, the author of <code>bnlearn</code>, and who is a leading expert in the field when it comes to all things BN. From the outset, I want to clarify that I am by no means an expert in Bayesian networks (far from it!), and encourage any reader who wants to learn more about the theory underlying BNs, or to see more in depth examples, to visit Marco’s site which is a fantastic place to start. I have also included a list of resources I found helpful when learning about BNs at the end of the post. That said, in this post I hope to show a motivating example that might spark some ideas about how BNs can be used!</p>
<h1 id="so-what-is-a-bayesian-network">So what is a Bayesian network?</h1>
<p>Wikipedia actually provides a nice overview, so I’ll <del>cheat</del> paraphrase from there…</p>
<blockquote>
<p>A Bayesian network is a probabilistic graphical model that represents a set of variables and their conditional dependencies via a directed acyclic graph (DAG). Bayesian networks are ideal for taking an event that occurred and predicting the likelihood that any one of several possible known causes was the contributing factor. For example, a Bayesian network could represent the probabilistic relationships between diseases and symptoms. Given symptoms, the network can be used to compute the probabilities of the presence of various diseases.</p>
</blockquote>
<p>So in really simple terms, a Bayesian network allows us to ask questions like “if the value of variable A is x and the value of variable B is y, what is the probability variable C of being value z?” Or, if the weather is looking overcast, and it rained yesterday, what is the probability the it will rain today?</p>
<p>There are some other important features that I am going to bullet point here for brevity:</p>
<ul>
<li>Nodes are variables in the networks, arcs are links between nodes.</li>
<li>Networks can be discrete (all variables are categorical), or continuous or a hybrid of both.</li>
<li>The structure of a network can be specified ahead of time if it is known, or it can learnt from the data, or a hybrid approach where both “expert knowledge” and a data driven approach to learning can be combined.</li>
<li>There are a range of different algorithms in <code>bnlearn</code> that can be used to learn a structure of a network from the data.</li>
<li>Once a network has been learnt, it can be queried or used for predictions.</li>
</ul>
<p>For me personally, the visual nature of Bayesian networks is really appealing, something which I’ll hopefully demonstrate in the following examples.</p>
<h1 id="enough-theory-some-examples">Enough theory, some examples!</h1>
<p>The data I’ve used here comes from my PhD, where I was investigating the relationships between stress-related factors and the risk of sports injury. I have simplified the data slightly here just to make the examples clearer. If interested in the full study, you can find the paper in published form <a href="https://www.frontiersin.org/articles/10.3389/fspor.2020.595619/abstract"><strong>here</strong></a> and the git repo for the paper <a href="https://github.com/hfshr/frontiers-paper"><strong>here</strong></a>.</p>
<p>The data contains the following variables:</p>
<ul>
<li>injured: Whether an injury was sustained during the study period</li>
<li>pi: Previous injury, whether the participant had sustained an injury in the 6 months preceding the study</li>
<li>gender: Gender of the participant</li>
<li>ind_team: Whether the participant competes in an individual or team sport</li>
<li>clevel: Competitive level, The highest level the participant had reached in competition</li>
<li>hours: Number of hours spent training per week</li>
<li>nlebase: Baseline negative life events</li>
<li>ri: Reward Interest (personalty characteristic)</li>
<li>fffs: Fight-Flight-Freeze System (personalty characteristic)</li>
<li>bis: Behavioural Inhibition System (personalty characteristic)</li>
<li>stiffness: Sum of all lower body stiffness locations</li>
<li>balance: Score on a balance test, higher score = poorer balance.</li>
<li>hrv: Heart rate variability, Root mean squared difference of successive RR intervals.</li>
</ul>
<p>Data can be found here: <a href="https://raw.githubusercontent.com/hfshr/distill_blog/master/_posts/2020-11-01-bayesian-networks-with-bnlearn/injuries.csv" class="uri">https://raw.githubusercontent.com/hfshr/distill_blog/master/_posts/2020-11-01-bayesian-networks-with-bnlearn/injuries.csv</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.bnlearn.com/'>bnlearn</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/gt'>gt</a></span><span class='op'>)</span>

<span class='va'>injuries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"injuries.csv"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.character</span><span class='op'>)</span>, <span class='va'>as.factor</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Each variable has two levels, as shown below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>injuries</span> <span class='op'>%&gt;%</span>
  <span class='fu'>gather</span><span class='op'>(</span><span class='va'>var</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>var</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%%</span> <span class='fl'>2</span> <span class='op'>==</span> <span class='fl'>0</span>, <span class='st'>"Level 1"</span>, <span class='st'>"Level 2"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>level</span>, values_from <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span>Variable <span class='op'>=</span> <span class='va'>var</span>, <span class='st'>"Level 1"</span>, <span class='st'>"Level 2"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/gt.html'>gt</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zlfqwjbzkb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zlfqwjbzkb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlfqwjbzkb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zlfqwjbzkb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zlfqwjbzkb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlfqwjbzkb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlfqwjbzkb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zlfqwjbzkb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zlfqwjbzkb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zlfqwjbzkb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zlfqwjbzkb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zlfqwjbzkb .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zlfqwjbzkb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zlfqwjbzkb .gt_from_md > :first-child {
  margin-top: 0;
}

#zlfqwjbzkb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zlfqwjbzkb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zlfqwjbzkb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zlfqwjbzkb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlfqwjbzkb .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zlfqwjbzkb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlfqwjbzkb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zlfqwjbzkb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zlfqwjbzkb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlfqwjbzkb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlfqwjbzkb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zlfqwjbzkb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlfqwjbzkb .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zlfqwjbzkb .gt_left {
  text-align: left;
}

#zlfqwjbzkb .gt_center {
  text-align: center;
}

#zlfqwjbzkb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zlfqwjbzkb .gt_font_normal {
  font-weight: normal;
}

#zlfqwjbzkb .gt_font_bold {
  font-weight: bold;
}

#zlfqwjbzkb .gt_font_italic {
  font-style: italic;
}

#zlfqwjbzkb .gt_super {
  font-size: 65%;
}

#zlfqwjbzkb .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="zlfqwjbzkb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Level 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Level 2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">balance</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">bis</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">clevel</td>
      <td class="gt_row gt_left">national_international</td>
      <td class="gt_row gt_left">club_university_county</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">fffs</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">gender</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_left">female</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">hours</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">hrv</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">ind_team</td>
      <td class="gt_row gt_left">team</td>
      <td class="gt_row gt_left">individual</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">injured</td>
      <td class="gt_row gt_left">injured</td>
      <td class="gt_row gt_left">healthy</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">nlebase</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">pi</td>
      <td class="gt_row gt_left">no injury</td>
      <td class="gt_row gt_left">injury</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">ri</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">stiffness</td>
      <td class="gt_row gt_left">Low</td>
      <td class="gt_row gt_left">High</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<h1 id="network-preparation">Network preparation</h1>
<p>To start, I simply extract the names of the variables into two character strings, one for the “explanatory” variables and one for the “control” variables. I’ll use these character vectors in later steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># select names of measured variables</span>
<span class='va'>explanatory_vars</span> <span class='op'>&lt;-</span> <span class='va'>injuries</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>stiffness</span><span class='op'>:</span><span class='va'>fffs</span>, <span class='va'>injured</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># select names of "explanatory" variables, e.g., gender</span>
<span class='va'>control_vars</span> <span class='op'>&lt;-</span> <span class='va'>injuries</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>pi</span><span class='op'>:</span><span class='va'>hours</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, I create a blacklist to restrict certain arcs between specific nodes from being learnt in the network. Specifically, I restrict the direction of the arcs from control <span class="math inline">\(\rightarrow\)</span> explanatory and restrict some arcs between the control variables, as these are not of interest.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## create blacklist</span>

<span class='va'>black_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span>
  from <span class='op'>=</span> <span class='va'>explanatory_vars</span>,
  to <span class='op'>=</span> <span class='va'>control_vars</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>bind_rows</span><span class='op'>(</span>
    <span class='va'>.</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"clevel"</span>, <span class='st'>"nlebase"</span>, <span class='st'>"nlebase"</span><span class='op'>)</span>,
      to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gender"</span>, <span class='st'>"ind_team"</span>, <span class='st'>"gender"</span><span class='op'>)</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>I also enforce a relationship between <code>nlebase</code> <span class="math inline">\(\rightarrow\)</span> <code>injured</code>. This is a relationship is often found in the literature, although for reasons I won’t get into here wasn’t apparent in the data I collected, but I still wanted to include this relationship in my analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## create whitelist</span>
<span class='va'>white_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"nlebase"</span><span class='op'>)</span>,
  to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"injured"</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="fitting-the-network">Fitting the network</h1>
<p>In bnlearn there are several algorithms available that can be used to learn the structure (for the full list see <a href="https://www.bnlearn.com/" class="uri">https://www.bnlearn.com/</a>). In this example, I have chosen the tabu search algorithm - a score-based algorithm that explores the search space starting from a simple network structure and adding, deleting, or reversing one arc at a time until the score can no longer be improved <span class="citation" data-cites="Olmedilla2018">(<a href="#ref-Olmedilla2018" role="doc-biblioref">Olmedilla et al. 2018</a>)</span>. I have also used the <code>boot.strength</code> function that allows <em>n</em> networks to be learnt via bootstrap samples. This enables the strength of each arc to be estimated by the number of times that particular arc is learnt during the sampling process.</p>
<aside>
<p>I’ve only used 100 repeats here for speed, in the real world you might consider using more to ensure robustness.</p>
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># set seed for reproducibility</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>122</span><span class='op'>)</span>

<span class='va'>str_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/arc.strength.html'>boot.strength</a></span><span class='op'>(</span>
  <span class='va'>injuries</span>,
  algorithm <span class='op'>=</span> <span class='st'>"tabu"</span>,
  algorithm.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    blacklist <span class='op'>=</span> <span class='va'>black_list</span>,
    whitelist <span class='op'>=</span> <span class='va'>white_list</span>,
    tabu <span class='op'>=</span> <span class='fl'>100</span>
  <span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Using the <code>averaged.network</code> function, I select all the arcs that were present in at least 30% of the learnt networks, this is equivalent to an arc strength of 0.3. An arc strength of 1 indicates that the arc was always present in the network, with the value decreasing as arcs were found in fewer networks.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>avg30</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/arc.strength.html'>averaged.network</a></span><span class='op'>(</span><span class='va'>str_network</span>, threshold <span class='op'>=</span> <span class='fl'>0.30</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can now plot the network to visualise the relationships that have been learnt. I use the <code>strength.plot</code> function which shows the strength of the relationship between arcs via different line styles in the plot. Thin, dashed arcs indicate the weakest arcs (arc strength below 0.50), whereas thick solid arcs indicate the strongest arcs (arc strengths approaching 1).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>Rgraphviz</span><span class='op'>)</span>

<span class='va'>gR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/strength.plot.html'>strength.plot</a></span><span class='op'>(</span>
  <span class='va'>avg30</span>,
  <span class='va'>str_network</span>,
  shape <span class='op'>=</span> <span class='st'>"rectangle"</span>,
  render <span class='op'>=</span> <span class='cn'>FALSE</span>,
  groups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>explanatory_vars</span>, <span class='va'>control_vars</span><span class='op'>)</span>,
  layout <span class='op'>=</span> <span class='st'>"dot"</span>
<span class='op'>)</span>

<span class='co'># Colour the variables of interest</span>
<span class='fu'>nodeRenderInfo</span><span class='op'>(</span><span class='va'>gR</span><span class='op'>)</span><span class='op'>$</span><span class='va'>fill</span><span class='op'>[</span><span class='va'>explanatory_vars</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"deepskyblue"</span>

<span class='co'># Colour the main outcome variable</span>
<span class='fu'>nodeRenderInfo</span><span class='op'>(</span><span class='va'>gR</span><span class='op'>)</span><span class='op'>$</span><span class='va'>fill</span><span class='op'>[</span><span class='st'>"injured"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"gold"</span>

<span class='co'># Show me the network!</span>
<span class='fu'><a href='https://rdrr.io/pkg/Rgraphviz/man/renderGraph.html'>renderGraph</a></span><span class='op'>(</span><span class='va'>gR</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="bayesian-networks-with-bnlearn_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<h1 id="interrogating-the-network">Interrogating the network</h1>
<p>Now we have learnt the network structure, we can use the network to answer queries about the probabilistic relationships in the network. This is achieved thorough using the conditional probabilities tables that give us the probability of an event, given other events. For example, take the stiffness node from the network above. We see there are two arcs linked to the stiffness node, pi <span class="math inline">\(\rightarrow\)</span> stiffness and gender <span class="math inline">\(\rightarrow\)</span> stiffness. To see these probability tables we can simple use:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># fit the network to the data</span>
<span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/bn.fit.html'>bn.fit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/cpdag.html'>cextend</a></span><span class='op'>(</span><span class='va'>avg30</span><span class='op'>)</span>, <span class='va'>injuries</span><span class='op'>)</span>

<span class='co'># Conditional probabilities for the stiffness node</span>
<span class='va'>fitted</span><span class='op'>$</span><span class='va'>stiffness</span><span class='op'>$</span><span class='va'>prob</span>
</code></pre>
</div>
<pre><code>, , gender = female

         pi
stiffness injury no injury
     High 0.7333    0.1304
     Low  0.2667    0.8696

, , gender = male

         pi
stiffness injury no injury
     High 0.6337    0.6087
     Low  0.3663    0.3913</code></pre>
</div>
<p>We can use this information to make a number of statements, for example, females with a previous injury (pi) are more likely to have “High” stiffness compared to males.</p>
<p>We may want to be a little more specific with our queries, for example say we want to know what the probability of an injury when stiffness == “High.” We can use <code>bnlearn::cpquery()</code> to ask this very question.</p>
<aside>
I’ve used likelihood weighting here(method = “lw”) which is an approximate inference algorithm based on Monte Carlo simulations, so you may get slightly different results when running this. Use <code>?bnlearn::cpquery</code> to see the different options available for sampling.
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># ask the query</span>
<span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/cpquery.html'>cpquery</a></span><span class='op'>(</span><span class='va'>fitted</span>,
  event <span class='op'>=</span> <span class='op'>(</span><span class='va'>injured</span> <span class='op'>==</span> <span class='st'>"injured"</span><span class='op'>)</span>,
  evidence <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>stiffness <span class='op'>=</span> <span class='st'>"High"</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"lw"</span>
<span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.3027</code></pre>
</div>
<p>Likewise we can ask the same question for when stiffness == “Low”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/cpquery.html'>cpquery</a></span><span class='op'>(</span><span class='va'>fitted</span>,
  event <span class='op'>=</span> <span class='op'>(</span><span class='va'>injured</span> <span class='op'>==</span> <span class='st'>"injured"</span><span class='op'>)</span>,
  evidence <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>stiffness <span class='op'>=</span> <span class='st'>"Low"</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"lw"</span>
<span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.176</code></pre>
</div>
<p>We can see that High stiffness almost doubles the probability of injury.</p>
<p>Now, this can get a little repetitive when you want to investigate lots of variables with different combinations, so I created a function that enables multiple variables to be passed in. It’s a bit lengthy and could probably be simplified a little, but it does the job…!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>probability_generator</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>vars</span>, <span class='va'>outcome</span>, <span class='va'>state</span>, <span class='va'>model</span>, <span class='va'>repeats</span> <span class='op'>=</span> <span class='fl'>500000</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>all.levels</span> <span class='op'>&lt;-</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vars</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>[</span>, <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>vars</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>levels</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>all.levels</span> <span class='op'>&lt;-</span> <span class='va'>.data</span> <span class='op'>%&gt;%</span>
      <span class='fu'>select</span><span class='op'>(</span><span class='fu'>all_of</span><span class='op'>(</span><span class='va'>vars</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>levels</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>combos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='st'>"expand.grid"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>all.levels</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># al combiations</span>

  <span class='co'># generate character strings for all combinations</span>
  <span class='va'>str1</span> <span class='op'>&lt;-</span> <span class='st'>""</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>combos</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>str1</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>combos</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>" = '"</span>,
      <span class='va'>combos</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>as.character</span><span class='op'>)</span>, <span class='st'>"'"</span>,
      sep <span class='op'>=</span> <span class='st'>""</span>, collapse <span class='op'>=</span> <span class='st'>", "</span>
    <span class='op'>)</span>
  <span class='op'>}</span>

  <span class='co'># repeat the string for more than one outcome</span>
  <span class='va'>str1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>str1</span>, times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>outcome</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>str1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"list("</span>, <span class='va'>str1</span>, <span class='st'>")"</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>

  <span class='co'># repeat loop for outcome variables (can have more than one outcome)</span>
  <span class='va'>all.levels.outcome</span> <span class='op'>&lt;-</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>outcome</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>[</span>, <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>outcome</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>levels</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>all.levels</span> <span class='op'>&lt;-</span> <span class='va'>.data</span> <span class='op'>%&gt;%</span>
      <span class='fu'>select</span><span class='op'>(</span><span class='fu'>all_of</span><span class='op'>(</span><span class='va'>outcome</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>levels</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>combos.outcome</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='st'>"expand.grid"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>all.levels.outcome</span><span class='op'>)</span><span class='op'>)</span>

  <span class='co'># repeat each outcome for the length of combos</span>
  <span class='va'>str3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"("</span>, <span class='va'>outcome</span>, <span class='st'>" == '"</span>, <span class='va'>state</span>, <span class='st'>"')"</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>str1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>outcome</span><span class='op'>)</span><span class='op'>)</span>

  <span class='co'># fit the model with bayes method</span>
  <span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/bn.fit.html'>bn.fit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/cpdag.html'>cextend</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span>, <span class='va'>.data</span>, method <span class='op'>=</span> <span class='st'>"bayes"</span>, iss <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

  <span class='co'># join all elements of string together</span>
  <span class='va'>cmd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"cpquery(fitted, "</span>, <span class='va'>str3</span>, <span class='st'>", "</span>, <span class='va'>str1</span>, <span class='st'>", method = 'lw', n = "</span>, <span class='va'>repeats</span>, <span class='st'>")"</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>

  <span class='va'>prob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>str1</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># empty vector for probabilities</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>cmd</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>prob</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/parse.html'>parse</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>cmd</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='co'># for each combination of strings, what is the probability of outcome</span>
  <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>combos</span>, <span class='va'>prob</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now, we know that the <code>injured</code> node is of the most interest here, so we might want to know what effect all the nodes that are connected to the injured node have on the probability of being injured. To find out what these other nodes are we can find the “Markov blanket” for the injured node. A Markov blanket contains all the nodes that make the node of interest conditionally independent from the rest of the network <span class="citation" data-cites="Fuster-Parra2017">(<a href="#ref-Fuster-Parra2017" role="doc-biblioref">Fuster-Parra et al. 2017</a>)</span>, and we can use the <code>bnlearn::mb</code> to find these nodes.</p>
<p>For example for the injured node we can do:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/mb.html'>mb</a></span><span class='op'>(</span><span class='va'>avg30</span>, <span class='st'>"injured"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;nlebase&quot;   &quot;clevel&quot;    &quot;hours&quot;     &quot;stiffness&quot; &quot;balance&quot;  </code></pre>
</div>
<p>and we find five nodes of interest.</p>
<p>With our <code>probability_generator</code> function, we can now pass in these nodes and find out the probability of the injured node being in the injured state for every combination of the nodes in the markov blanket. Remember each node can contains only two possible states, so we should end up with 2^5 = 32 combinations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>markov_blanket</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/bnlearn/man/mb.html'>mb</a></span><span class='op'>(</span><span class='va'>avg30</span>, <span class='st'>"injured"</span><span class='op'>)</span>

<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>probability_generator</span><span class='op'>(</span><span class='va'>injuries</span>,
  vars <span class='op'>=</span> <span class='va'>markov_blanket</span>,
  outcome <span class='op'>=</span> <span class='st'>"injured"</span>,
  state <span class='op'>=</span> <span class='st'>"injured"</span>,
  model <span class='op'>=</span> <span class='va'>avg30</span>
<span class='op'>)</span>

<span class='co'># Check number of rows, should = 32</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 32</code></pre>
</div>
<p>32 combinations may be a bit much to look at, so here I make a quick function to get the top 3 highest and lowest probabilities for comparison.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>toptail</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>n</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>data</span> <span class='op'>%&gt;%</span>
    <span class='fu'>top_n</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>prob</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>data</span> <span class='op'>%&gt;%</span>
      <span class='fu'>top_n</span><span class='op'>(</span><span class='va'>n</span>, <span class='op'>-</span><span class='va'>prob</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>res</span> <span class='op'>%&gt;%</span>
  <span class='fu'>toptail</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>prob</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span>Probability <span class='op'>=</span> <span class='va'>prob</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/gt.html'>gt</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_row_group.html'>tab_row_group</a></span><span class='op'>(</span>
    group <span class='op'>=</span> <span class='st'>"Low risk"</span>,
    rows <span class='op'>=</span> <span class='va'>Probability</span> <span class='op'>&lt;=</span> <span class='fl'>0.25</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_row_group.html'>tab_row_group</a></span><span class='op'>(</span>
    group <span class='op'>=</span> <span class='st'>"High risk"</span>,
    rows <span class='op'>=</span> <span class='va'>Probability</span> <span class='op'>&gt;</span> <span class='fl'>0.25</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_options.html'>tab_options</a></span><span class='op'>(</span>row_group.font.weight <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cols_align.html'>cols_align</a></span><span class='op'>(</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/fmt_number.html'>fmt_number</a></span><span class='op'>(</span>columns <span class='op'>=</span> <span class='st'>"Probability"</span>, decimals <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vhtivxcuks .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vhtivxcuks .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vhtivxcuks .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vhtivxcuks .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vhtivxcuks .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vhtivxcuks .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vhtivxcuks .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vhtivxcuks .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vhtivxcuks .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vhtivxcuks .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vhtivxcuks .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vhtivxcuks .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vhtivxcuks .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vhtivxcuks .gt_from_md > :first-child {
  margin-top: 0;
}

#vhtivxcuks .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vhtivxcuks .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vhtivxcuks .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#vhtivxcuks .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vhtivxcuks .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#vhtivxcuks .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vhtivxcuks .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vhtivxcuks .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vhtivxcuks .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vhtivxcuks .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vhtivxcuks .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#vhtivxcuks .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vhtivxcuks .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#vhtivxcuks .gt_left {
  text-align: left;
}

#vhtivxcuks .gt_center {
  text-align: center;
}

#vhtivxcuks .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vhtivxcuks .gt_font_normal {
  font-weight: normal;
}

#vhtivxcuks .gt_font_bold {
  font-weight: bold;
}

#vhtivxcuks .gt_font_italic {
  font-style: italic;
}

#vhtivxcuks .gt_super {
  font-size: 65%;
}

#vhtivxcuks .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="vhtivxcuks" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Probability</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">nlebase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">clevel</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">hours</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">stiffness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">balance</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="6" class="gt_group_heading">High risk</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.51</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">club_university_county</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.43</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">national_international</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">Low</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.41</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">national_international</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">High</td>
      <td class="gt_row gt_center">High</td>
    </tr>
    <tr class="gt_group_heading_row">
      <td colspan="6" class="gt_group_heading">Low risk</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.05</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">national_international</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">Low</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.05</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">national_international</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">High</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">0.04</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">club_university_county</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">Low</td>
      <td class="gt_row gt_center">Low</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<p>So from this we can conclude those athlete who have “High” combination of training hours, muscle stiffness and poor balance (“High” in this case means a worse score on a balance test) have a much higher risk of injury than those athletes with the opposite profile. Coaches or athletes could use this information to try and reduce their risk of injury by improving their balance or lowering their training hours in a run up to competition. The simple interpretations make this a particularly useful tool in applied settings, which I think is really important.</p>
<h1 id="bonus-visulaisation-with-bnviewer">Bonus visulaisation with {bnviewer}</h1>
<p>I recently found the <code>bnviewer</code> package which provides an alternative way to visualising networks generated in <code>bnlearn</code> by leveraging the powerful <code>visNetwork</code> package (that uses vis.js under the hood). Below I plot our network using <code>strength.viewer</code> function, and the results are pretty cool!</p>
<aside>
<p>You can drag the nodes around and hover over them for more information regarding the arcs. Also looks better in dark mode - click the light bulb in the site header!</p>
</aside>
<div class="niceNetwork">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://robsonfernandes.net/bnviewer/'>bnviewer</a></span><span class='op'>)</span>
  

<span class='fu'><a href='https://rdrr.io/pkg/bnviewer/man/strength.viewer.html'>strength.viewer</a></span><span class='op'>(</span>
  bayesianNetwork <span class='op'>=</span> <span class='va'>avg30</span>,
  bayesianNetwork.boot.strength <span class='op'>=</span> <span class='va'>str_network</span>,
  bayesianNetwork.arc.strength.threshold.expression <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='st'>"@threshold &gt; 0 &amp; @threshold &lt; 0.5"</span>,
    <span class='st'>"@threshold &gt;= 0.5 &amp; @threshold &lt;= 0.8"</span>,
    <span class='st'>"@threshold &gt; 0.8 &amp; @threshold &lt;= 1"</span>
  <span class='op'>)</span>,
  bayesianNetwork.arc.strength.threshold.expression.color  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>, <span class='st'>"yellow"</span>, <span class='st'>"blue"</span><span class='op'>)</span>,
  bayesianNetwork.arc.strength.threshold.alternative.color <span class='op'>=</span>  <span class='st'>"lightgreen"</span>,
  bayesianNetwork.arc.strength.label <span class='op'>=</span> <span class='cn'>TRUE</span>,
  bayesianNetwork.arc.strength.label.prefix <span class='op'>=</span> <span class='st'>""</span>,
  bayesianNetwork.arc.strength.label.color <span class='op'>=</span> <span class='st'>"lightgreen"</span>,
  bayesianNetwork.arc.strength.tooltip <span class='op'>=</span> <span class='cn'>TRUE</span>,
  bayesianNetwork.edge.scale.min <span class='op'>=</span> <span class='fl'>1</span>,
  bayesianNetwork.edge.scale.max <span class='op'>=</span> <span class='fl'>3</span>,
  bayesianNetwork.edge.scale.label.min <span class='op'>=</span> <span class='fl'>14</span>,
  bayesianNetwork.edge.scale.label.max <span class='op'>=</span> <span class='fl'>14</span>,
  bayesianNetwork.width <span class='op'>=</span> <span class='st'>"100%"</span>,
  bayesianNetwork.height <span class='op'>=</span> <span class='st'>"800px"</span>,
  bayesianNetwork.layout <span class='op'>=</span> <span class='st'>"layout_with_sugiyama"</span>,
  node.colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"gray"</span>,
            border <span class='op'>=</span> <span class='st'>"#2b7ce9"</span>,
            highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#e91eba"</span>,
                    border <span class='op'>=</span> <span class='st'>"#2b7ce9"</span><span class='op'>)</span><span class='op'>)</span>,
  
  node.font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"lightgreen"</span>, face<span class='op'>=</span><span class='st'>"Arial"</span><span class='op'>)</span>,
  edges.dashes <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-1a7a8dc6e06c020cfab1" style="width:100%;height:800px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1a7a8dc6e06c020cfab1">{"x":{"nodes":{"id":["injured","pi","nlebase","gender","ind_team","clevel","hours","stiffness","ri","bis","hrv","balance","fffs"],"label":[" injured"," pi"," nlebase"," gender"," ind_team"," clevel"," hours"," stiffness"," ri"," bis"," hrv"," balance"," fffs"],"x":[-0.428571428571429,-1,-0.142857142857143,0.714285714285714,-0.285714285714286,-1,-0.142857142857143,-0.714285714285714,-0.142857142857143,1,0.428571428571429,-0.428571428571429,1],"y":[0.333333333333333,-0.333333333333333,-0.333333333333333,-1,-0.666666666666667,0,-1,0,1,0,0,0.666666666666667,0.333333333333333]},"edges":{"from":["injured","pi","pi","nlebase","nlebase","nlebase","nlebase","gender","gender","ind_team","ind_team","clevel","clevel","hours","hours","hours","stiffness","bis","balance"],"to":["balance","clevel","stiffness","injured","ri","bis","hrv","stiffness","fffs","pi","nlebase","pi","balance","injured","ind_team","hrv","injured","fffs","ri"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"dashes":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"value":[0.33,0.355,0.585,1,0.9,0.57,0.415,0.74,0.425,0.335,0.835,0.355,0.59,0.32,0.895,0.325,0.54,0.985,0.32],"width":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"color":["red","red","yellow","blue","blue","yellow","red","yellow","red","red","blue","red","yellow","red","blue","red","yellow","blue","red"],"title":["<br><b> Causal Relationships : <\/b>injured &rarr; balance<br><br><b> Edge Strength : <\/b>0.33<br><br>","<br><b> Causal Relationships : <\/b>pi &rarr; clevel<br><br><b> Edge Strength : <\/b>0.355<br><br>","<br><b> Causal Relationships : <\/b>pi &rarr; stiffness<br><br><b> Edge Strength : <\/b>0.585<br><br>","<br><b> Causal Relationships : <\/b>nlebase &rarr; injured<br><br><b> Edge Strength : <\/b>1<br><br>","<br><b> Causal Relationships : <\/b>nlebase &rarr; ri<br><br><b> Edge Strength : <\/b>0.9<br><br>","<br><b> Causal Relationships : <\/b>nlebase &rarr; bis<br><br><b> Edge Strength : <\/b>0.57<br><br>","<br><b> Causal Relationships : <\/b>nlebase &rarr; hrv<br><br><b> Edge Strength : <\/b>0.415<br><br>","<br><b> Causal Relationships : <\/b>gender &rarr; stiffness<br><br><b> Edge Strength : <\/b>0.74<br><br>","<br><b> Causal Relationships : <\/b>gender &rarr; fffs<br><br><b> Edge Strength : <\/b>0.425<br><br>","<br><b> Causal Relationships : <\/b>ind_team &rarr; pi<br><br><b> Edge Strength : <\/b>0.335<br><br>","<br><b> Causal Relationships : <\/b>ind_team &rarr; nlebase<br><br><b> Edge Strength : <\/b>0.835<br><br>","<br><b> Causal Relationships : <\/b>clevel &rarr; pi<br><br><b> Edge Strength : <\/b>0.355<br><br>","<br><b> Causal Relationships : <\/b>clevel &rarr; balance<br><br><b> Edge Strength : <\/b>0.59<br><br>","<br><b> Causal Relationships : <\/b>hours &rarr; injured<br><br><b> Edge Strength : <\/b>0.32<br><br>","<br><b> Causal Relationships : <\/b>hours &rarr; ind_team<br><br><b> Edge Strength : <\/b>0.895<br><br>","<br><b> Causal Relationships : <\/b>hours &rarr; hrv<br><br><b> Edge Strength : <\/b>0.325<br><br>","<br><b> Causal Relationships : <\/b>stiffness &rarr; injured<br><br><b> Edge Strength : <\/b>0.54<br><br>","<br><b> Causal Relationships : <\/b>bis &rarr; fffs<br><br><b> Edge Strength : <\/b>0.985<br><br>","<br><b> Causal Relationships : <\/b>balance &rarr; ri<br><br><b> Edge Strength : <\/b>0.32<br><br>"],"label":[" 0.33"," 0.355"," 0.585"," 1"," 0.9"," 0.57"," 0.415"," 0.74"," 0.425"," 0.335"," 0.835"," 0.355"," 0.59"," 0.32"," 0.895"," 0.325"," 0.54"," 0.985"," 0.32"],"font":["10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen","10px Arial lightgreen"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"background":"gray","border":"#2b7ce9","highlight":{"background":"#e91eba","border":"#2b7ce9"}},"font":{"color":"lightgreen","face":"Arial"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":[],"scaling":{"min":1,"max":3,"label":{"enabled":true,"min":14,"max":14}},"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":"100%","height":"800px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;"},"footer":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;"},"background":null,"iconsRedraw":true,"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<h1 id="summary">Summary</h1>
<p>So that was a very quick intro to Bayesian Networks! As promised, below I have included some resources that I’d highly recommend if you want to take a deeper dive into Bayesian networks. Thanks for reading!</p>
<h2 class="appendix" id="resources">Resources</h2>
<ul>
<li><p><a href="https://www.bnlearn.com/" class="uri">https://www.bnlearn.com/</a> - Marco’s / bnlearn website</p></li>
<li><p><a href="https://kevintshoemaker.github.io/NRES-746/BayesianNetworks-1.html" class="uri">https://kevintshoemaker.github.io/NRES-746/BayesianNetworks-1.html</a> - a great blog post about BNs</p></li>
<li><p><a href="https://bookdown.org/robertness/causalml/docs/tutorial-probabilistic-modeling-with-bayesian-networks-and-bnlearn.html" class="uri">https://bookdown.org/robertness/causalml/docs/tutorial-probabilistic-modeling-with-bayesian-networks-and-bnlearn.html</a> another good starting point covering the basics</p></li>
<li><p><a href="https://www.frontiersin.org/articles/10.3389/fvets.2020.00073/full" class="uri">https://www.frontiersin.org/articles/10.3389/fvets.2020.00073/full</a> Kratzer et al., (2020) paper I found while writing this post that gives a great walkthough, although not using bnlearn.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Fuster-Parra2017" class="csl-entry" role="doc-biblioentry">
Fuster-Parra, P., J. Vidal-Conti, P. A. Borràs, and P. Palou. 2017. <span>“<span class="nocase">Bayesian networks to identify statistical dependencies. A case study of Spanish university students’ habits</span>.”</span> <em>Informatics for Health and Social Care</em> 42 (2): 166–79. <a href="https://doi.org/10.1080/17538157.2016.1178117">https://doi.org/10.1080/17538157.2016.1178117</a>.
</div>
<div id="ref-Olmedilla2018" class="csl-entry" role="doc-biblioentry">
Olmedilla, Aurelio, Víctor J. Rubio, Pilar Fuster-Parra, Constanza Pujals, and Alexandre García-Mas. 2018. <span>“<span class="nocase">A Bayesian approach to sport injuries likelihood: Does player’s self-efficacy and environmental factors plays the main role?</span>”</span> <em>Frontiers in Psychology</em> 9: 1–10. <a href="https://doi.org/10.3389/fpsyg.2018.01174">https://doi.org/10.3389/fpsyg.2018.01174</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
