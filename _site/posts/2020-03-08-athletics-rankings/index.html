<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.272">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-03-08">
<meta name="description" content="Using R to gather data from an athletics rankings website.">

<title>Data Code &amp; Coffee - Athletics rankings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Code &amp; Coffee</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software/index.html">Projects</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/hfshr"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/hfshr"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-the-data" id="toc-getting-the-data" class="nav-link active" data-scroll-target="#getting-the-data">Getting the data</a>
  <ul class="collapse">
  <li><a href="#individual-athletes" id="toc-individual-athletes" class="nav-link" data-scroll-target="#individual-athletes">Individual athletes</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Athletics rankings</h1>
  <div class="quarto-categories">
    <div class="quarto-category">athletics</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Using R to gather data from an athletics rankings website.</p>
  </div>
</div>




<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">03/08/2020</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>As a keen athlete I spent many hours on athletics rankings website https://www.thepowerof10.info. For athletics nerds, the site is fantastic and provides all the information you need to keep up to date with the latest results. However, I wondered if it might be possible to explore some alternative ways of presenting the results…</p>
<section id="getting-the-data" class="level1 page-columns page-full">
<h1>Getting the data</h1>
<p>Initially, I had to figure out a way to first gather the data from the power of 10 website. As you can see in the screenshot below, the rankings are already in a table format, so thankfully it wasn’t too difficult to figure something out.</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-2_8ec6ee9ad7b8982db1c2da6d4697e846">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/powerof10homepage.PNG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/powerof10homepage.PNG" class="external img-fluid figure-img" width="489"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure from https://www.thepowerof10.info</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>This was my first time using the <a href="http://rvest.tidyverse.org/"><code>rvest</code></a> package, so I’m sure this code can be improved somewhat… It does, however, seem to do the trick. To start, I identified a url from one of the ranking pages that would serve as a starting point to access the site.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_f18fb25e794a08fc2e75fc2c146ea4db">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://www.thepowerof10.info/rankings/rankinglist.aspx?event=100&amp;agegroup=ALL&amp;sex=M&amp;year=2012"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To access other pages it was just a case of supplying new values to the arguments in the url. For example to get the 200m rankings I could just swap the “event=100” for “event=200” in the string. To do this, I wrote a simple function that would generate a vector of strings with the desired events, years and for male or female athletes.</p>
<div class="cell" data-hash="index_cache/html/url_0e7bdc2050c1b0650dc196b8e4e70efb">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>urlmaker <span class="ot">&lt;-</span> <span class="cf">function</span>(years, events, gender) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"https://www.thepowerof10.info/rankings/rankinglist.aspx?event=100&amp;agegroup=ALL&amp;sex=M&amp;year=2012"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  baseevent <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">2</span>]])</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  baseyear <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">3</span>]])</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  newyear <span class="ot">&lt;-</span> <span class="fu">rep</span>(years, <span class="at">times =</span> <span class="fu">length</span>(events))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  list_of_years <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(url, baseyear, newyear)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  newevent <span class="ot">&lt;-</span> <span class="fu">rep</span>(events, <span class="at">each =</span> <span class="fu">length</span>(years))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  yearandevent <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(list_of_years, baseevent, newevent)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  sex <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"sex="</span>, gender, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  yearandevent <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(yearandevent, <span class="st">"sex=M"</span>, sex)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(yearandevent)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I then created a string of events and years I wanted to scrape. In this instance I only wanted male athletes, so also set gender to “M”. The result was a vector of urls as character strings that I could use to access the necessary pages.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_4ea3a84ec1376fb0d7c0f850bc47f33d">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"200"</span>, <span class="st">"400"</span>, <span class="st">"800"</span>, <span class="st">"1500"</span>, <span class="st">"3000"</span>, <span class="st">"5000"</span>, <span class="st">"10000"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2006</span>, <span class="at">to =</span> <span class="dv">2018</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="st">"M"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of urls to use for scraping</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">urlmaker</span>(years, events, gender)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(urls, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "https://www.thepowerof10.info/rankings/rankinglist.aspx?event=100&amp;agegroup=ALL&amp;sex=M&amp;year=2006"
[2] "https://www.thepowerof10.info/rankings/rankinglist.aspx?event=100&amp;agegroup=ALL&amp;sex=M&amp;year=2007"
[3] "https://www.thepowerof10.info/rankings/rankinglist.aspx?event=100&amp;agegroup=ALL&amp;sex=M&amp;year=2008"</code></pre>
</div>
</div>
<p>Next, I had to figure out a way to actually get the data. Inspecting the html code on the page helped to identify the labels for the tables that I needed.</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-8_bb3183b57f0e7416b95743854de3b8a9">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/po10_window.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/po10_window.png" class="external img-fluid figure-img" width="857"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure from https://www.thepowerof10.info</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Once I knew how the different elements on the page were identified, it was as easy as copying and pasting the table id into <code>html_nodes()</code> and converting to a table with <code>html_table()</code>. After that it was just the usual wrangling you’d expect with a messy data frame.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_6262a802690e5d78e45771e85e49b192">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>readtable <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  main <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  rankings <span class="ot">&lt;-</span> main <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="at">xpath =</span> <span class="st">'//*[@id="cphBody_lblCachedRankingList"]/table'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"rank"</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"perf"</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"windy"</span>, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"windspeed"</span>, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PB"</span>, </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"newpb"</span>, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"name"</span>, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"agegroup"</span>, </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"month_year"</span>, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"coach"</span>, </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"club"</span>, </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"venue"</span>, </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">"date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">year =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">3</span>]]),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">event =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">2</span>]])</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(name), <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">replace</span>(., . <span class="sc">==</span> <span class="st">""</span>, <span class="cn">NA</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">na.locf</span>(name))</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I simply had to pass the url to the function, and we’ll have the table from the webpage stored as a dataframe.</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-12_637680915b72973a91388bfbc5777a99">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">readtable</span>(url)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ranks <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, perf, name, year, club, venue) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 22%">
<col style="width: 7%">
<col style="width: 31%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">rank</th>
<th style="text-align: left;">perf</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: left;">club</th>
<th style="text-align: left;">venue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Belgrave</td>
<td style="text-align: left;">Olympic Park</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">10.05</td>
<td style="text-align: left;">Adam Gemili</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Blackheath &amp; Bromley</td>
<td style="text-align: left;">Barcelona, ESP</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">10.13</td>
<td style="text-align: left;">James Dasaolu</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Croydon</td>
<td style="text-align: left;">Olympic Park</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If I wanted to scrape multiple urls at once I would use <code>map_df</code>. Here I can pass my vector of urls and <code>map_df</code> will perform the scraping function <code>readtable</code> on each element in the vector and append the result together (this can take a while to complete so I’ll just use the first 3 urls from our vector of 104 urls).</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-14_e7d65af944acd263d59a8942f37239ed">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>urls_short <span class="ot">&lt;-</span> urls[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>male_rankings <span class="ot">&lt;-</span> urls_short <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(readtable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can view the top ranked athlete for each year.</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-16_69e4c1b73e5d83721c29fefdf980de8e">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>male_rankings <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">==</span> <span class="st">"1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, rank, perf, name, club, venue) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">rank</th>
<th style="text-align: left;">perf</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">club</th>
<th style="text-align: left;">venue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">10.07</td>
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">Belgrave</td>
<td style="text-align: left;">Gateshead</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">10.06</td>
<td style="text-align: left;">Marlon Devonish</td>
<td style="text-align: left;">Coventry</td>
<td style="text-align: left;">Lausanne, SUI</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">10.00</td>
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">Belgrave</td>
<td style="text-align: left;">Birmingham</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="individual-athletes" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="individual-athletes">Individual athletes</h2>
<p>The PO10 also provides detailed performance history for individual athletes. I wanted to be able to have access to this data as well, however I wanted to avoid downloading every individual athletes data to disk as I imagine that may have taken a while…</p>
<p>Instead the solution I came up with was a function get each individual athlete’s unique identifier number. With this number I could get each athletes individual rankings when required using an “on the fly” scrape, as a single athletes page is not very much data at all.</p>
<p>The screenshot below shows how the code that I needed to extract</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-18_2583550b625e50dc4edc73be3c2af01a">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/po10id.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/po10id.png" class="external img-fluid figure-img" width="858"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure from https://www.thepowerof10.info</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The function below collects the athltes name, unique url, year and event.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-20_6f5478b15d35f2ffe344edc7dd34c82a">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>athleteurl <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  main <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  athleteinfo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">html_text</span>(<span class="fu">html_nodes</span>(main, <span class="st">"td:nth-child(7) a"</span>), <span class="st">"href"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">athleteurl =</span> <span class="fu">html_attr</span>(<span class="fu">html_nodes</span>(main, <span class="st">"td:nth-child(7) a"</span>), <span class="st">"href"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">3</span>]]),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">event =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract_all</span>(url, <span class="st">"[0-9]+"</span>)[[<span class="dv">1</span>]][[<span class="dv">2</span>]])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">""</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">athleteurl</span>(url)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 4
  name                   athleteurl                               year event
  &lt;chr&gt;                  &lt;chr&gt;                                   &lt;dbl&gt; &lt;dbl&gt;
1 Dwain Chambers         /athletes/profile.aspx?athleteid=31816   2012   100
2 Adam Gemili            /athletes/profile.aspx?athleteid=208735  2012   100
3 James Dasaolu          /athletes/profile.aspx?athleteid=22721   2012   100
4 Harry Aikines-Aryeetey /athletes/profile.aspx?athleteid=19988   2012   100
5 Mark Lewis-Francis     /athletes/profile.aspx?athleteid=21139   2012   100
6 James Alaka            /athletes/profile.aspx?athleteid=22255   2012   100</code></pre>
</div>
</div>
<p>In another function I join these two tables together so I had one data frame that had all the results and rankings as well as each athletes individual id that I could use to get their individual data. I also appended the full address to each individual athletes id.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-22_1c0a124d44c6cefc3f8bd5826c06fd6d">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>finaljoin <span class="ot">&lt;-</span> <span class="cf">function</span>(ranks, ids, gender) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  yeartimes <span class="ot">&lt;-</span> ranks <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, event) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(rank, <span class="st">"[:alpha:]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(year, rank) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(rank, <span class="st">"^UK"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate</span>(rank, <span class="fu">c</span>(<span class="st">"topn"</span>, <span class="st">"timing"</span>), <span class="st">": "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">spread</span>(<span class="at">key =</span> topn, <span class="at">value =</span> timing) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  cleanrankings <span class="ot">&lt;-</span> ranks <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(rank, <span class="st">"[:alpha:]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(., ids, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"year"</span>, <span class="st">"event"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">athleteurl =</span> <span class="fu">paste</span>(<span class="st">"https://www.thepowerof10.info"</span>, athleteurl, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  cleanrankings <span class="ot">&lt;-</span> <span class="fu">left_join</span>(cleanrankings, yeartimes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"event"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gender =</span> gender)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This left me with a complete dataframe I could work with, with the options of getting individual athletes data as needed,</p>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-24_1bb4b93c06f6e2a6a20ca642425e0620">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>clean_ranks <span class="ot">&lt;-</span> <span class="fu">finaljoin</span>(<span class="at">ranks =</span> ranks, <span class="at">ids =</span> ids, <span class="at">gender =</span> <span class="st">"M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Adding missing grouping variables: `event`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>clean_ranks <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, perf, name, year, club, venue, athleteurl) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 15%">
<col style="width: 3%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">rank</th>
<th style="text-align: left;">perf</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: left;">club</th>
<th style="text-align: left;">venue</th>
<th style="text-align: left;">athleteurl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Belgrave</td>
<td style="text-align: left;">Olympic Park</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=31816</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">10.05</td>
<td style="text-align: left;">Adam Gemili</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Blackheath &amp; Bromley</td>
<td style="text-align: left;">Barcelona, ESP</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=208735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">10.13</td>
<td style="text-align: left;">James Dasaolu</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Croydon</td>
<td style="text-align: left;">Olympic Park</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=22721</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">10.20</td>
<td style="text-align: left;">Harry Aikines-Aryeetey</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Sutton &amp; District</td>
<td style="text-align: left;">Rovereto, ITA</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=19988</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">10.21</td>
<td style="text-align: left;">Mark Lewis-Francis</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Birchfield H</td>
<td style="text-align: left;">Mesa AZ, USA</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=21139</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">10.22</td>
<td style="text-align: left;">James Alaka</td>
<td style="text-align: right;">2012</td>
<td style="text-align: left;">Blackheath &amp; Bromley</td>
<td style="text-align: left;">Eugene OR, USA</td>
<td style="text-align: left;">https://www.thepowerof10.info/athletes/profile.aspx?athleteid=22255</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The final function I used was to scrape and clean each individuals rankings “on the fly”. The only input is an athletes individual url. The result was another dataframe that contains an individual athletes history of performances.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-26_1069cdc33c24262fdfffc951a7b98a93">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>individual <span class="ot">&lt;-</span> <span class="cf">function</span>(athlete) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  history <span class="ot">&lt;-</span> athlete <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_html</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="at">xpath =</span> <span class="st">'//*[@id = "cphBody_pnlPerformances"]/table'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(X4, X5, X8, X9)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"event"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"perf"</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"indoor"</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"position"</span>, </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"heat"</span>, </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"venue"</span>, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"meeting"</span>, </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(event, <span class="st">"[:alpha:]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">dmy</span>(date),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">year =</span> <span class="fu">substr</span>(date, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">perf_time =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(perf, <span class="st">":"</span>) <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="st">"00:00:"</span>, perf),</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_length</span>(<span class="fu">str_split_fixed</span>(perf, <span class="st">"."</span>, <span class="dv">4</span>)[<span class="dv">4</span>]) <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="fu">str_c</span>(perf, <span class="st">"0"</span>),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_length</span>(perf) <span class="sc">==</span> <span class="dv">6</span> <span class="sc">|</span> <span class="fu">str_length</span>(perf) <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="st">"00:0"</span>, perf),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_length</span>(perf) <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> <span class="fu">str_length</span>(perf) <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="st">"00:"</span>, perf),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> perf</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">&lt;-</span> <span class="fu">read_html</span>(athlete)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">&lt;-</span> <span class="fu">html_text</span>(<span class="fu">html_nodes</span>(name, <span class="at">css =</span> <span class="st">"h2"</span>), <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  history <span class="ot">&lt;-</span> history <span class="sc">%&gt;%</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> name)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(history)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-hash="index_cache/html/unnamed-chunk-28_94861be0c5442b6ba9ecace86c46fd5f">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>athlete <span class="ot">&lt;-</span> <span class="st">"https://www.thepowerof10.info/athletes/profile.aspx?athleteid=31816"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">individual</span>(athlete) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, event, perf, position, venue, meeting, date) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 47%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">event</th>
<th style="text-align: left;">perf</th>
<th style="text-align: left;">position</th>
<th style="text-align: left;">venue</th>
<th style="text-align: left;">meeting</th>
<th style="text-align: left;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">10.91</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">Sportcity</td>
<td style="text-align: left;">Müller British Championships inc. Invitation 10000m</td>
<td style="text-align: left;">2021-06-25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">6.73</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Lee Valley</td>
<td style="text-align: left;">South of England AA U20 / Senior Championships</td>
<td style="text-align: left;">2020-02-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">6.74</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Lee Valley</td>
<td style="text-align: left;">South of England AA U20 / Senior Championships</td>
<td style="text-align: left;">2020-02-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">6.76</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Lee Valley</td>
<td style="text-align: left;">London U20 / Senior Games</td>
<td style="text-align: left;">2020-01-19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dwain Chambers</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">6.77</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">Lee Valley</td>
<td style="text-align: left;">Scienhealth Athletics Invitational</td>
<td style="text-align: left;">2020-01-05</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So that’s it! I am currently in the process of creating an interactive dashboard to visualise these results. You can see an early version here:</p>
<p>https://harryfish.shinyapps.io/resultsdashboard/</p>
<p>Lots of work left to do, but any comments or feedback are always welcome. The source code is on my <a href="https://github.com/HarryFisher1/power_of_10">github</a> if you want to try anything out.</p>
<p>Thanks for reading!</p>


</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="hfshr/distill_blog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>