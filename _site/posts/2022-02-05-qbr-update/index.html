<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.272">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Quick post to highligh some of the major updates in {qbr} v1.0.0">

<title>Data Code &amp; Coffee - qbr v1.0.0</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Code &amp; Coffee</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software/index.html">Projects</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/hfshr"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/hfshr"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#qbr-v1.0.0" id="toc-qbr-v1.0.0" class="nav-link active" data-scroll-target="#qbr-v1.0.0">{qbr} v1.0.0</a></li>
  <li><a href="#so-whats-new" id="toc-so-whats-new" class="nav-link" data-scroll-target="#so-whats-new">So, whats new?</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">qbr v1.0.0</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">javascript</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Quick post to highligh some of the major updates in {qbr} v1.0.0</p>
  </div>
</div>




<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2022/02/09</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="qbr-v1.0.0" class="level2">
<h2 class="anchored" data-anchor-id="qbr-v1.0.0">{qbr} v1.0.0</h2>
<p>Recently I made some major changes to the <code>qbr</code> package I released back in June 2020. As a quick refresher, <code>qbr</code> is an R wrapper around the popular javascript library <a href="https://querybuilder.js.org/">queryBuilder</a>. In short, it provides a nice UI for constructing queries that can be used to filter data and also plays nicely with Shiny as its two main dependencies are bootstrap and jquery.</p>
<p>I initially developed <code>qbr</code> using the <code>htmlwidgets</code> framework, guided by an earlier attempt at integrating the library with R by <a href="https://github.com/harveyl888/queryBuilder">@harveyl888</a>. However after using <code>qbr</code> in a couple of projects at work, I found there were a few limitations, particularly when it came to updating the widget with new filters. So this latest attempt moves away from the <code>htmlwidgets</code> approach and instead uses a custom input binding for Shiny, and implements some additional functionality, all with the aim of making the library easier to use and customise as required.</p>
</section>
<section id="so-whats-new" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="so-whats-new">So, whats new?</h2>
<p>Below are just a few of the highlights in the new version of <code>qbr</code> - checkout the <a href="https://hfshr.github.io/qbr/#/">documentation</a> for more details!</p>
<p><strong>Support for different bootstrap versions</strong></p>
<p>While not “officially” supported by the original js library, some kind folk have made suggested some fixes that enable the library to be used with bootstrap 4+. Within the new <code>useQueryBuilder()</code> function you can set <code>bs_version</code> to one of “3”, “4” or “5” (default is “3”) in order to make sure the builder looks and functions ok with newer versions of boostrap. This is especially useful if you’re using <code>bslib</code> to update the bootstrap version used by shiny!</p>
<p><strong>Easily update the builder with</strong> <code>updateQueryBuilder()</code></p>
<p>The original library has many methods that can used to on an existing builder. Currently <code>updateQueryBuilder()</code> supports the following,</p>
<ul>
<li><code>reset</code>: Removes all rules from the builder,</li>
<li><code>destroy</code>: Self explanatory..!,</li>
<li><code>setRules</code>: Load a predetermined set of rules into the builder.</li>
<li><code>setFilters</code>: Remove all existing filters and add a new set of filters to the builder</li>
<li><code>addFilter</code>: Add a filter to the existing filters</li>
</ul>
<p>I’ve found these to be particularly useful when you need to builder to update depending on the data or a users actions in the app.</p>
<p><strong>Choose your output</strong></p>
<p>In the <code>queryBuilderInput()</code> function, you can use the <code>return_value</code> argument to choose the output that gets returned to shiny. This can be one of:</p>
<ul>
<li><code>"r_rules"</code>: Returns the filter condition formatted for R</li>
<li><code>"sql_rules"</code>: Returns the filter condition formatted for SQL</li>
<li><code>"rules"</code>: list of conditions, default output from original queryBuilder library</li>
<li><code>"all"</code>: Return all of the above in a named list.</li>
</ul>
<p>The aim here is to try and give the user more control over what output is returned.</p>
<p><strong>Conditional dependencies for widgets</strong></p>
<p>queryBuilder supports many different plugins and widgets that depend on additional dependencies. In the previous version of qbr, all of these dependencies were loaded in when you used the builder, even if you didn’t use any of the plugins or widgets! This led to a noticeable increase in loading time, and was just unnecessary. Now, only the dependencies for the requested plugins will be loaded, which should improve the loading time of the builder and is generally more efficient.</p>
<section id="demo" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="demo">Demo</h3>
<p>Below is a demo app using a couple of different configurations available.</p>
<div class="column-screen-inset">
<iframe src="https://harryfish.shinyapps.io/qbr_demo/" allowfullscreen="" scrolling="yes" width="100%" height="800px" frameboarder="0" data-external="1">
</iframe>
</div>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>So there it is! I still have a few ideas that I’d like to implement and generally make the package more robust, but in the mean time I’d love any feedback on the package, so feel free to drop a comment or <a href="https://github.com/hfshr/qbr/issues">open an issue</a> on github. Thanks for reading!</p>


</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="hfshr/distill_blog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>